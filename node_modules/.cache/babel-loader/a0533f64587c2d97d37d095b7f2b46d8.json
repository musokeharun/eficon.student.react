{"ast":null,"code":"import _objectSpread from\"/home/haruna/eficon.apps/student.eficon/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/home/haruna/eficon.apps/student.eficon/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _createForOfIteratorHelper from\"/home/haruna/eficon.apps/student.eficon/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _classCallCheck from\"/home/haruna/eficon.apps/student.eficon/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/haruna/eficon.apps/student.eficon/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/haruna/eficon.apps/student.eficon/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/haruna/eficon.apps/student.eficon/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import Joi from\"joi-browser\";import Input from\"./input\";import Select from\"./select\";var Form=/*#__PURE__*/function(_Component){_inherits(Form,_Component);var _super=_createSuper(Form);function Form(){var _this;_classCallCheck(this,Form);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:{},errors:{}};_this.validate=function(){var options={abortEarly:false};var _Joi$validate=Joi.validate(_this.state.data,_this.schema,options),error=_Joi$validate.error;if(!error)return null;var errors={};var _iterator=_createForOfIteratorHelper(error.details),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;errors[item.path[0]]=item.message;}}catch(err){_iterator.e(err);}finally{_iterator.f();}return errors;};_this.validateProperty=function(_ref){var name=_ref.name,value=_ref.value;var obj=_defineProperty({},name,value);var schema=_defineProperty({},name,_this.schema[name]);var _Joi$validate2=Joi.validate(obj,schema),error=_Joi$validate2.error;return error?error.details[0].message:null;};_this.handleSubmit=function(e){e.preventDefault();var errors=_this.validate();_this.setState({errors:errors||{}});if(errors)return;_this.doSubmit();};_this.handleFileChange=function(name,value){var state=_objectSpread({},_this.state);state.files[name]=value;_this.setState(state);};_this.handleChange=function(_ref2){var input=_ref2.currentTarget;var errors=_objectSpread({},_this.state.errors);var errorMessage=_this.validateProperty(input);if(errorMessage)errors[input.name]=errorMessage;else delete errors[input.name];var data=_objectSpread({},_this.state.data);data[input.name]=input.value;_this.setState({data:data,errors:errors});};return _this;}_createClass(Form,[{key:\"renderButton\",value:function renderButton(label,className){var classNames=className||\"btn btn-primary\";return/*#__PURE__*/React.createElement(\"button\",{disabled:this.validate(),className:classNames},label);}},{key:\"renderSelect\",value:function renderSelect(name,label,options){var _this$state=this.state,data=_this$state.data,errors=_this$state.errors;return/*#__PURE__*/React.createElement(Select,{name:name,value:data[name],label:label,options:options,onChange:this.handleChange,error:errors[name]});}},{key:\"renderInput\",value:function renderInput(name,label){var type=arguments.length>2&&arguments[2]!==undefined?arguments[2]:\"text\";var _this$state2=this.state,data=_this$state2.data,errors=_this$state2.errors;return/*#__PURE__*/React.createElement(Input,{type:type,name:name,value:data[name],label:label,onChange:this.handleChange,error:errors[name]});}}]);return Form;}(Component);export default Form;","map":{"version":3,"sources":["/home/haruna/eficon.apps/student.eficon/src/components/common/form.jsx"],"names":["React","Component","Joi","Input","Select","Form","state","data","errors","validate","options","abortEarly","schema","error","details","item","path","message","validateProperty","name","value","obj","handleSubmit","e","preventDefault","setState","doSubmit","handleFileChange","files","handleChange","input","currentTarget","errorMessage","label","className","classNames","type"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport Joi from \"joi-browser\";\nimport Input from \"./input\";\nimport Select from \"./select\";\n\nclass Form extends Component {\n    state = {\n        data: {},\n        errors: {}\n    };\n\n    validate = () => {\n        const options = {abortEarly: false};\n        const {error} = Joi.validate(this.state.data, this.schema, options);\n        if (!error) return null;\n\n        const errors = {};\n        for (let item of error.details) errors[item.path[0]] = item.message;\n        return errors;\n    };\n\n    validateProperty = ({name, value}) => {\n        const obj = {[name]: value};\n        const schema = {[name]: this.schema[name]};\n        const {error} = Joi.validate(obj, schema);\n        return error ? error.details[0].message : null;\n    };\n\n    handleSubmit = e => {\n        e.preventDefault();\n\n        const errors = this.validate();\n        this.setState({errors: errors || {}});\n        if (errors) return;\n\n        this.doSubmit();\n    };\n\n    handleFileChange = (name, value) => {\n        const state = {...this.state};\n        state.files[name] = value;\n        this.setState(state);\n    }\n\n\n    handleChange = ({currentTarget: input}) => {\n        const errors = {...this.state.errors};\n        const errorMessage = this.validateProperty(input);\n        if (errorMessage) errors[input.name] = errorMessage;\n        else delete errors[input.name];\n\n        const data = {...this.state.data};\n        data[input.name] = input.value;\n\n        this.setState({data, errors});\n    };\n\n    renderButton(label, className) {\n\n        const classNames = className || \"btn btn-primary\";\n\n        return (\n            <button disabled={this.validate()} className={classNames}>\n                {label}\n            </button>\n        );\n    }\n\n    renderSelect(name, label, options) {\n        const {data, errors} = this.state;\n\n        return (\n            <Select\n                name={name}\n                value={data[name]}\n                label={label}\n                options={options}\n                onChange={this.handleChange}\n                error={errors[name]}\n            />\n        );\n    }\n\n    renderInput(name, label, type = \"text\") {\n        const {data, errors} = this.state;\n\n        return (\n            <Input\n                type={type}\n                name={name}\n                value={data[name]}\n                label={label}\n                onChange={this.handleChange}\n                error={errors[name]}\n            />\n        );\n    }\n}\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}